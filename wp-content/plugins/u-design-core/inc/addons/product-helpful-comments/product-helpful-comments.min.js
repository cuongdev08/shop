window.theme||(window.theme={}),function(e){var t={action:"alpha_get_comments",post_id:null,filter:{type:"all",order:"default"},page:1,$pagination:null,$target:null,$current:null,loading:!1,cache:{},init:function(){this.$pagination=e(".woocommerce-Reviews .pagination"),this.post_id=e(".woocommerce-Reviews #comments").data("id"),e(".woocommerce-Reviews .commentlist.active").length?this.$current=this.$target=e(".woocommerce-Reviews .commentlist.active"):this.$current=this.$target=e(".woocommerce-Reviews .commentlist"),e("body").on("change",".woocommerce-Reviews .select-box select",this.filterComments).on("click",".woocommerce-Reviews .nav-link",this.filterCommentsByTab).on("click",".woocommerce-pagination a.page-numbers",this.changePage).on("click",".review-vote .comment_help, .review-vote .comment_unhelp",this.onVoteComment)},filterComments:function(a){var n=e(this);n.data("filter")&&(t.filter[n.data("filter")]=n.val(),t.page=1,t.getComments())},filterCommentsByTab:function(a){var n=e(this);if(!t.loading){var s="SPAN"==this.tagName?n.data("href"):n.attr("href");t.$target="#"==s?n.closest(".nav").siblings(".tab-content").children(".tab-pane").eq(n.parent().index()):e(("#"==s.substring(0,1)?"":"#")+s),t.$target.length&&(a.preventDefault(),t.$current=t.$target.parent().children(".active"),!n.hasClass("active")&&s&&(n.closest(".nav-tabs").find(".active").removeClass("active"),n.addClass("active"),t.filter.type=n.data("type"),t.page=1,t.getComments()))}},changePage:function(a){var n=e(this),s=n.attr("href");a.preventDefault(),n.hasClass("prev")?t.page=parseInt(n.siblings(".current").text())-1:n.hasClass("next")?t.page=parseInt(n.siblings(".current").text())+1:t.page=parseInt(n.text()),t.getComments(s),e("html,body").stop().animate({scrollTop:e(".commentlist").offset().top-200})},getComments:function(a=""){t.loading=!0,t.$current.length&&theme.doLoading(t.$current),e.post(alpha_vars.ajax_url,{action:this.action,nonce:alpha_vars.nonce,post_id:this.post_id,page:this.page,...this.filter},(function({html:e,pagination:n}){t.loading=!1,t.$current&&theme.endLoading(t.$current),!e.trim()&&t.$target.data("empty")?t.$target.html(t.$target.data("empty")):t.$target.html(e),t.$pagination.html(n),n?t.$pagination.removeClass("d-none"):t.$pagination.addClass("d-none"),t.changeContent(),a&&history.pushState({},"",a)}))},changeContent:function(){theme.loadTemplate(this.$target),theme.slider(this.$target.find(".slider-wrapper")),this.$target.hasClass("tab-pane")&&(this.$current.removeClass("in active"),this.$target.addClass("active in")),this.$current=this.$target,theme.refreshLayouts()},onVoteComment:function(a){var n=e(this),s=n.data("comment_id"),i=n.hasClass("comment_help")?"fa-thumbs-up":"fa-thumbs-down";e("#alpha_review_vote-"+s+" ."+i).removeClass(i).addClass("fa-spinner fas"),e("#alpha_review_vote-"+s).css("pointer-events","none"),e.post(alpha_vars.ajax_url,{action:"comment_vote",nonce:alpha_vars.nonce,comment_id:s,commentvote:n.hasClass("comment_help")?"plus":"minus"},(function(a){if(a){var o=JSON.parse(a);t.$current.find("#commenthelp-count-"+s).text(""==o.plus?0:o.plus),t.$current.find("#commentunhelp-count-"+s).text(""==o.minus?0:o.minus),e("#alpha_review_vote-"+s+" .fa-spinner.fas").removeClass("fa-spinner fas").addClass(i),n.hasClass("already-voted")?n.removeClass("already-voted"):n.addClass("already-voted").siblings(".btn").removeClass("already-voted")}else e("#alpha_review_vote-"+s+" .fa-spinner.fas").removeClass("fa-spinner fas").addClass(i),e("#alpha_review_vote-"+s+" .comment_alert").fadeIn(500,(function(){e(this).fadeOut(2500)}));e("#alpha_review_vote-"+s).css("pointer-events","")}))}};theme.ProductHelpfulComments=t,theme.$window.on("alpha_complete",(function(){theme.ProductHelpfulComments.init()}))}(jQuery);