!function(a,e){"use strict";window.themeAdmin=themeAdmin||{};var l={init:function(){var a=this;e(".alpha_custom_labels .color-picker").wpColorPicker(),e(".save_alpha_product_options").on("click",a.onExtraSave),e("#alpha_add_custom_label").on("click",a.addLabel),e(".alpha_custom_labels").on("click",".delete",a.removeLabel),e(".alpha_custom_labels").on("change",".custom_label_type",a.typeSelected),e(document).off("click",".btn_upload_img").on("click",".btn_upload_img",a.uploadFile),a.sortableLabels()},addLabel:function(){var a=e(this).closest(".form-field");a.siblings(".wc-metabox-template").clone().show().appendTo(a.find(".wc-metaboxes")),e.fn.wpColorPicker&&(a.find(".color-picker").addClass("alpha-color-picker"),a.find("input.alpha-color-picker").wpColorPicker())},removeLabel:function(a){a.preventDefault(),e(this).closest(".wc-metabox").remove()},typeSelected:function(){e(this).val()?(e(this).siblings(".text-controls").hide(),e(this).siblings(".image-controls").show()):(e(this).siblings(".image-controls").hide(),e(this).siblings(".text-controls").show())},uploadFile:function(l){var o,t=e(this),i=t.prev(),n=t.next();o||(o=a.media.frames.downloadable_file=a.media({title:"Choose an image",button:{text:"Use image"},multiple:!1})),o.open(),o.on("select",(function(){var a=o.state().get("selection").first().toJSON();i.val(a.url),o.close(),n.val(a.id)})),l.preventDefault()},sortableLabels:function(){e(".alpha_custom_labels .wc-metaboxes").sortable({items:".wc-metabox",cursor:"move",axis:"y",handle:"h3",scrollSensitivity:40,forcePlaceholderSize:!0,helper:"clone",opacity:.65,placeholder:"wc-metabox-sortable-placeholder",start:function(a,e){e.item.css("background-color","#f6f6f6")},stop:function(a,e){e.item.removeAttr("style")}})},onExtraSave:function(a){a.preventDefault();var l=[],o=e("#alpha_data_addons");l.alpha_custom_labels=[],e(".alpha_custom_labels").find(".wc-metabox").each((function(){var a={};a.type=e(this).find(".custom_label_type").val(),a.type?(a.img_url=e(this).find(".label_image").val(),a.img_id=e(this).find(".label_image_id").val()):(a.label=e(this).find(".label_text").val(),a.color=e(this).find('[name="label_color"]').val(),a.bgColor=e(this).find('[name="label_bgcolor"]').val()),(!a.type&&a.label||a.type&&a.img_url)&&l.alpha_custom_labels.push(a)})),l.alpha_extra_info=e("#alpha_extra_info").val(),o.block({message:null,overlayCSS:{background:"#fff",opacity:.6}}),e.ajax({type:"POST",dataType:"json",url:alpha_product_data_addon_vars.ajax_url,data:{action:"alpha_save_product_extra_options",nonce:alpha_product_data_addon_vars.nonce,post_id:alpha_product_data_addon_vars.post_id,alpha_custom_labels:l.alpha_custom_labels,alpha_extra_info:l.alpha_extra_info},success:function(){o.unblock()}})},onCancel:function(a){confirm("Changes are cancelled. Do you want to reload this page?")&&window.location.reload()}};themeAdmin.productDataAddons=l,e(document).ready((function(){themeAdmin.productDataAddons.init()}))}(wp,jQuery);