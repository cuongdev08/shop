"use strict";window.themeAdmin=window.themeAdmin||{},function(a){var i={$form:a("#alpha-critical-form"),$tableForm:a("#alpha-critical-table-form"),$progressBar:a(".alpha-progress-bar"),criticalDone:0,criticalTodo:0,init:function(){var i=a("#alpha-select-particular");i.select2({placeholder:i.attr("data-placeholder")}),a("#alpha-critical-page").on("change",(function(){"individual_pages"==a(this).val()?a("label[for=alpha-select-particular]").removeClass("disabled"):a("label[for=alpha-select-particular]").addClass("disabled")})),0==a(".temp-iframe").length&&a("body").append('<iframe class="temp-iframe" style="max-width: none; max-height: none; border: 0px;" aria-hidden="true" sandbox="allow-same-origin "></iframe>'),this.$form.on("submit",(function(i){i.preventDefault(),themeAdmin.criticalWizard.$progressBar.css({width:"0"}),themeAdmin.criticalWizard.$progressBar.removeClass("failed"),a(this).find("button").addClass("disabled").html('<i class="fas fa-spinner fa-spin"></i> '+wp.i18n.__("Generating Critical","alpha-core")),a.post(ajaxurl,themeAdmin.criticalWizard.$form.serialize(),(async function(i){if("object"==typeof i.data){var e=i.data,t=Object.keys(e).length;if(0==t)return;themeAdmin.criticalWizard.$progressBar.css({width:"10%"}),themeAdmin.criticalWizard.criticalDone=0,themeAdmin.criticalWizard.criticalTodo=t;for(var r=Object.keys(e),c=0;c<r.length;c++){var l=r[c],s={};await themeAdmin.criticalCss.main(e[l].desktop),s.desktop={css:themeAdmin.criticalCss.resultCriticalCss,preload:themeAdmin.criticalCss.resultPreload},await themeAdmin.criticalCss.main(e[l].mobile,"mobile",!0),s.mobile={css:themeAdmin.criticalCss.resultCriticalCss,preload:themeAdmin.criticalCss.resultPreload},await a.post(ajaxurl,{action:"alpha_save_critical",id:l,pageCriticalCss:s,_wpnonce:themeAdmin.criticalWizard.$tableForm.data("nonce")},(function(a){console.log(a)}))}await a.post(ajaxurl,{action:"alpha_clear_merged_css",_wpnonce:themeAdmin.criticalWizard.$tableForm.data("nonce")},(function(a){})),themeAdmin.criticalWizard.$progressBar.css({width:"101%"})}location.reload(!0)}))})),this.$tableForm.on("click",".alpha-recompile-row",(function(i){i.preventDefault();var e=a(this);if(e.hasClass("disabled"))return!1;themeAdmin.criticalWizard.$progressBar.css({width:"0"}),themeAdmin.criticalWizard.$progressBar.removeClass("failed"),themeAdmin.criticalWizard.$tableForm.find(".button").addClass("disabled"),e.html('<i class="fas fa-spinner fa-spin"></i> '+wp.i18n.__("Recompile","alpha-core")),a.post(ajaxurl,{action:"alpha_critical_get_page",alpha_critical_page:"individual_pages",alpha_select_particular:e.closest("tr").attr("data-page-id"),alpha_critical_nonce:themeAdmin.criticalWizard.$tableForm.attr("data-nonce")},(async function(i){if("object"==typeof i.data){var e=i.data,t=Object.keys(e).length;if(0==t)return;themeAdmin.criticalWizard.$progressBar.css({width:"10%"}),themeAdmin.criticalWizard.criticalDone=0,themeAdmin.criticalWizard.criticalTodo=t;var r={},c=Object.keys(e)[0];await themeAdmin.criticalCss.main(e[c].desktop),r.desktop={css:themeAdmin.criticalCss.resultCriticalCss,preload:themeAdmin.criticalCss.resultPreload},await themeAdmin.criticalCss.main(e[c].mobile,"mobile",!0),r.mobile={css:themeAdmin.criticalCss.resultCriticalCss,preload:themeAdmin.criticalCss.resultPreload},await a.post(ajaxurl,{action:"alpha_save_critical",id:c,pageCriticalCss:r,_wpnonce:themeAdmin.criticalWizard.$tableForm.data("nonce")},(function(a){console.log(a)})),await a.post(ajaxurl,{action:"alpha_clear_merged_css",_wpnonce:themeAdmin.criticalWizard.$tableForm.data("nonce")},(function(a){})),themeAdmin.criticalWizard.$progressBar.css({width:"101%"})}location.reload(!0)}))})),this.$tableForm.on("submit",(function(i){var e=a(this);if("alpha_bulk_delete_critical"!=e.find("#bulk-action-selector-top").val()&&(i.preventDefault(),"-1"!=e.find("#bulk-action-selector-top").val())){themeAdmin.criticalWizard.$tableForm.find(".button").addClass("disabled"),e.find(".button.action").html('<i class="fas fa-spinner fa-spin"></i> '+wp.i18n.__("Apply","alpha-core")),themeAdmin.criticalWizard.$progressBar.css({width:"0"}),themeAdmin.criticalWizard.$progressBar.removeClass("failed");var t=[];e.find("tbody tr").each((function(){a(this).find('input[type="checkbox"]').is(":checked")&&t.push(a(this).attr("data-page-id"))})),a.post(ajaxurl,{action:"alpha_critical_get_page",alpha_critical_page:"individual_pages","alpha_select_particular[]":t,alpha_critical_nonce:e.attr("data-nonce")},(async function(i){if("object"==typeof i.data){var e=i.data,t=Object.keys(e).length;if(0==t)return;themeAdmin.criticalWizard.$progressBar.css({width:"10%"}),themeAdmin.criticalWizard.criticalDone=0,themeAdmin.criticalWizard.criticalTodo=t;for(var r=Object.keys(e),c=0;c<r.length;c++){var l=r[c],s={};await themeAdmin.criticalCss.main(e[l].desktop),s.desktop={css:themeAdmin.criticalCss.resultCriticalCss,preload:themeAdmin.criticalCss.resultPreload},await themeAdmin.criticalCss.main(e[l].mobile,"mobile",!0),s.mobile={css:themeAdmin.criticalCss.resultCriticalCss,preload:themeAdmin.criticalCss.resultPreload},await a.post(ajaxurl,{action:"alpha_save_critical",id:l,pageCriticalCss:s,_wpnonce:themeAdmin.criticalWizard.$tableForm.data("nonce")},(function(a){console.log(a)}))}await a.post(ajaxurl,{action:"alpha_clear_merged_css",_wpnonce:themeAdmin.criticalWizard.$tableForm.data("nonce")},(function(a){})),themeAdmin.criticalWizard.$progressBar.css({width:"101%"})}location.reload(!0)}))}}))}};themeAdmin.criticalWizard=i,a(document).ready((function(){i.init()}))}(window.jQuery);